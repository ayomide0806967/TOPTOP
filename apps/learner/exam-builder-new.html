<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz Builder | Academic Nightingale</title>
    <link rel="stylesheet" href="../assets/tailwind.css" />
    <link rel="stylesheet" href="../shared/design-system.css" />
    <link rel="stylesheet" href="../shared/quiz-components.html" />
    <script>
      window.__SUPABASE_CONFIG__ = window.__SUPABASE_CONFIG__ || {
        url: 'https://ghnhfagydcynhkgbazbj.supabase.co',
        anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdobmhmYWd5ZGN5bmhrZ2JhemJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwMDM2MjQsImV4cCI6MjA3NDU3OTYyNH0.KHgZ_ESTneR0CqWBGfu-JOmI3eBBLCZr1XG-g2vpclw',
      };
    </script>
</head>
<body class="min-h-screen bg-brand-light">
    <div class="flex min-h-screen flex-col">
      <!-- Header -->
      <header class="border-b border-medium bg-card sticky top-0 z-sticky backdrop-blur-lg bg-opacity-90">
        <div class="mx-auto max-w-7xl px-4 py-4 sm:px-6">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <img src="../assets/academicnightingale-logo.jpg" alt="Academic Nightingale" class="h-10 w-10 rounded-lg object-cover shadow-sm" />
              <div>
                <a href="../quizbuilder/instructor.html" class="btn btn-ghost btn-sm">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 18l-6-6 6-6" />
                  </svg>
                  Back to Dashboard
                </a>
                <h1 class="mt-2 text-2xl font-bold text-primary">Quiz Builder</h1>
                <p class="mt-1 text-sm text-secondary">Create and manage questions for your quiz blueprint.</p>
              </div>
            </div>
            <div class="flex items-center gap-2">
              <button id="preview-quiz-btn" class="btn btn-secondary">
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
                Preview Quiz
              </button>
              <button id="export-quiz-btn" class="btn btn-secondary">
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                Export Quiz
              </button>
              <button id="save-quiz-btn" class="btn btn-primary">
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V2" />
                </svg>
                Save Blueprint
              </button>
              <button id="publish-quiz-btn" class="btn btn-success">
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
                Publish Quiz
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="flex-1">
        <div class="mx-auto max-w-7xl">
          <div class="flex gap-8">
            <!-- Questions Container -->
            <div class="flex-1 py-6">
              <div class="mb-6">
                <h2 class="text-xl font-semibold text-primary mb-2">Quiz Questions</h2>
                <p class="text-secondary">Add and organize your quiz questions here.</p>
              </div>

              <!-- Questions will be added here -->
              <div class="quiz-questions-container space-y-6">
                <!-- Initial question will be added by JavaScript -->
              </div>

              <!-- Add Question Button -->
              <div class="mt-6">
                <button class="add-question-btn btn btn-primary w-full">
                  <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                  </svg>
                  Add Question
                </button>
              </div>
            </div>

            <!-- Sidebar -->
            <aside class="quiz-sidebar w-80 border-l border-medium bg-card">
              <div class="p-6 space-y-6">
                <!-- Quiz Settings -->
                <div class="quiz-settings card">
                  <div class="card-header pb-3">
                    <h3 class="font-semibold text-primary">Quiz Settings</h3>
                  </div>
                  <div class="card-body space-y-4">
                    <div>
                      <label class="block text-sm font-medium text-secondary mb-2">Quiz Title</label>
                      <input type="text" class="quiz-title input w-full" placeholder="Enter quiz title">
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-secondary mb-2">Description</label>
                      <textarea class="quiz-description input w-full resize-none" rows="3" placeholder="Brief description of the quiz"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                      <div>
                        <label class="block text-sm font-medium text-secondary mb-2">Time Limit</label>
                        <div class="flex items-center gap-2">
                          <input type="number" class="time-limit input w-20" value="30" min="1" max="180">
                          <span class="text-sm text-secondary">min</span>
                        </div>
                      </div>
                      <div>
                        <label class="block text-sm font-medium text-secondary mb-2">Attempts</label>
                        <select class="attempts input">
                          <option value="1">1</option>
                          <option value="2">2</option>
                          <option value="3">3</option>
                          <option value="unlimited">Unlimited</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Question Palette -->
                <div class="question-palette card">
                  <div class="card-header pb-3">
                    <h3 class="font-semibold text-primary">Questions</h3>
                    <span class="text-sm text-muted" id="question-count">0 questions</span>
                  </div>
                  <div class="card-body">
                    <div class="question-list space-y-2" id="question-list">
                      <!-- Question items will be dynamically inserted -->
                    </div>
                  </div>
                </div>

                <!-- Preview Section -->
                <div class="preview-section card">
                  <div class="card-header pb-3">
                    <h3 class="font-semibold text-primary">Preview</h3>
                  </div>
                  <div class="card-body">
                    <div class="space-y-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-secondary">Total Points:</span>
                        <span class="font-semibold" id="total-points">0</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-secondary">Time Limit:</span>
                        <span class="font-semibold" id="preview-time">30 min</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-secondary">Passing Score:</span>
                        <span class="font-semibold" id="passing-score">70%</span>
                      </div>
                    </div>
                    <button class="preview-quiz-btn btn btn-secondary w-full mt-4">
                      <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                        <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd" />
                      </svg>
                      Preview Quiz
                    </button>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        </div>
      </main>
    </div>

    <!-- Load Quiz Engine -->
    <script src="../shared/quiz-engine.js"></script>
    <script>
      // Initialize quiz builder when DOM is ready
      document.addEventListener('DOMContentLoaded', () => {
        // Add initial question
        setTimeout(() => {
          if (window.quizEngine) {
            window.quizEngine.addQuestion();
          }
        }, 100);

        // Setup button listeners
        document.getElementById('preview-quiz-btn')?.addEventListener('click', () => {
          // Preview functionality
          console.log('Preview quiz clicked');
        });

        document.getElementById('export-quiz-btn')?.addEventListener('click', () => {
          // Export functionality
          console.log('Export quiz clicked');
        });

        document.getElementById('save-quiz-btn')?.addEventListener('click', () => {
          // Save functionality
          if (window.quizEngine) {
            window.quizEngine.saveQuiz();
          }
        });

        document.getElementById('publish-quiz-btn')?.addEventListener('click', () => {
          // Publish functionality
          console.log('Publish quiz clicked');
        });
      });
    </script>
</body>
</html>